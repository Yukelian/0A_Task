#include "bsp.h"

Input_time Input_dev;

extern uint8_t esp01s_RxData[64];
uint8_t c;
BSP_TypeDef _BSP;
UART1_TypeDef BSP_UART1;
SPI1_TypeDef BSP_SPI1;

/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/
void bsp_Init(void)
{
    systickConfigure();

    bsp_esp01s_Init();
    _BSP._UART1 = BSP_UART1;
}

/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/
void Input_dev_choose(void)
{
    Input_dev.Input_Choose1 = time_Input_Choose1;
    Input_dev.Input_Choose2 = time_Input_Choose2;
};

/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/

void HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
{
    if (htim->Instance == TIM2) 
    {
        Input_dev.Input_Choose1();
    }
}

/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/
void HAL_TIM_IC_CaptureCallback(TIM_HandleTypeDef *htim)
{
    if (htim->Instance == TIM2) 
    {
        Input_dev.Input_Choose2();
    }
}

/*************************************************************************************************************************************************************
 *   ??    ??????????????????
 ************************************************************************************************************************************************************/
/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/
void HAL_UART_RxCpltCallback(UART_HandleTypeDef *huart)
{
    if (huart == &huart1)
    {
        _BSP._UART1.UART1_RxReceive();
    }
    if (huart == &huart2)
    {
        _BSP._UART2.UART1_RxReceive();
    }
}

/*
*********************************************************************************************************
*	?? ?? ??: 
*	???????: 
*	??    ??: 
*	?? ?? ?: 
*   ??    ???
*********************************************************************************************************
*/
uint8_t reLen = 0;                  
uint8_t nrf24l01RxBuffer[32] = {0}; 
void HAL_SPI_TxRxCpltCallback(SPI_HandleTypeDef *hspi)
{
    reLen = NRF24L01_RxPacket(nrf24l01RxBuffer);
}